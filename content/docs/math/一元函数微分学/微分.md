---
weight: 3
bookCollapseSection: false
title: "微分"
---

## 定义

设函数 \(y=f(x)\) 在点 \(x_0\) 的某邻域内有定义，且 \(x_0+\Delta x\) 在该邻域内，对于函数增量 \(\Delta y=f(x_0+\Delta x)−f(x_0)\)，若存在与\(\Delta x\) 无关的常数 \(A\)，使得\(\Delta y = A \Delta x+ o(\Delta x)\)，  
其中 \(o(\Delta x)\) 是在 \(\Delta x \to 0\) 时比 \(\Delta x\) 更高阶的无穷小，则称 \(y=f(x)\) 在点 \(x_0\) 处可微，  
并把增量的主要部分 \(A \Delta x\) 称为线性主部，也叫作 \(y=f(x)\) 在点 \(x_0\) 处的微分，通常把自变量 \(x\) 的增量 \(\Delta x\) 称为自变量的微分，记作 \(dx\)，即 \(dx=\Delta x\) 

函数 \(y=f(x)\) 在点 \(x\) 处可微与可导是等价的，且 \(A=f’(x_0)\)，微分又可记作 \(dy|_{x=x_0}=f'(x_0)dx\)，即微分等于导数乘以自变量的微分，函数的微分与自变量的微分之商等于该函数的，因此，导数也叫做微商

微分的几何意义：函数曲线在该点处的切线段的长度，局部用切线段近似代替曲线段。

计算：对函数求导，乘以自变量的微分dx，微分法则参看之前的求导公式

可微、可导、连续 三者之间的关系  
可微 \(\iff\) 可导  
可导 \(\implies\) 连续，连续不一定可导，比如 \(y=|x|\)


证明过程：
\[
\begin{aligned}
& 设\lim_{x\to x_0}\frac{f(x) - f(x_0)}{x - x_0} = A ，那么 \\
& \\
& \lim_{x\to x_0}\frac{f(x) - f(x_0)}{x - x_0} \cdot (x-x_0) = A\cdot0 = 0 \\
& \therefore \lim_{x\to x_0}f(x) = f(x_0)，函数在点x_0处连续
\end{aligned}
\]

## 微分中值定理

“微分中值”通常是在说，一个函数连续且可导的区间，这个区间可以找到至少一点，在这一点上的导数（微分）可以代表或者概括这个区间上函数整体平均的变化趋势。

### 费马引理

理解为极值点可导，导数为0；可导的极值点一定是驻点

设函数 \(f(x)\) 在点 \(x_0\) 的某邻域 \(U(x_0)\) 内有定义，并且在 \(x_0\) 处可导，如果对 \(\forall x \in U(x_0)\)，有 \(f(x) \le f(x_0)\)(或 \(f(x) \ge f(x_0)\))，则\(f'(x_0) = 0\)

**证明：**
\[
\begin{align*}
& 设 x \in U(x_0)，有 f(x) \le f(x_0)，对于x_0 + \Delta x \in U(x_0)，有 f(x_0 + \Delta x) \le f(x_0) \\
& \Delta x > 0时, \frac{f(x_0 + \Delta x)-f(x_0)}{\Delta x} \le 0 \\
& \Delta x < 0时, \frac{f(x_0 + \Delta x)-f(x_0)}{\Delta x} \ge 0 \\
& f'_+(x_0) = \lim_{\Delta x \to 0^+}\frac{f(x_0 + \Delta x)-f(x_0)}{\Delta x} \le 0 \\
& f'_-(x_0) = \lim_{\Delta x \to 0^-}\frac{f(x_0 + \Delta x)-f(x_0)}{\Delta x} \ge 0 \\
& f(x)在x_0处可导，所以 f'_+(x_0) = f'_-(x_0)，f'(x_0) = 0
\end{align*}
\]

### 罗尔中值定理

函数在两个端点处值相等，不论如何增减，显然都会存在至少一个极值点；几何意义：弧上至少有一点 ，曲线在该点切线是水平的。

设函数 \(f(x)\) 满足：
1. 闭区间 \([a,b]\) 连续；
2. 开区间 \((a,b)\) 可导；
3. \(f(a) = f(b)\)，则存在 \(\xi\in(a,b)\)，使得\(f'(\xi) = 0\)

**证明：** 函数 \(f(x)\) 在闭区间 \([a,b]\) 上连续，所以存在最大值与最小值，分别用 \(M\) 和 \(m\) 表示
1. 若 \(m=M\)，\(f(x)\) 在闭区间 \([a,b]\) 上为常函数，满足
2. 若 \(M>m\)，因为 \(f(a)=f(b)\)，所以 \((a,b)\) 内至少存在一点 \(\xi\)，使得 \(f(\xi) = m\) 或 \(f(\xi) = M\) 
即 \(x=\xi\) 是 \(f(x)\) 在闭区间 \([a,b]\) 上的极值点，由费马引理 \(f'(\xi) = 0\) 

几种特殊情况：
1. 若函数 \(f(x)\) 在区间 \((a,b)\) 上连续且可导，并有 \(\lim_{x\to a^+}f(x) = \lim_{x\to b^-}f(x) = c 或 \pm\infty\)，则至少存在一个 \(\xi\in(a,b)\)，使得 \(f'(\xi) = 0\) 
2. 若函数 \(f(x)\) 在区间 \((-\infty,+\infty)\) 上连续且可导，并有 \(\lim_{x\to -\infty}f(x) = \lim_{x\to +\infty}f(x) = c 或 \pm\infty\)，则至少存在一个 \(\xi\in(-\infty,+\infty)\)，使得 \(f'(\xi) = 0\) 
3. 若函数 \(f(x)\) 在区间 \([a,+\infty)\) 上连续且可导，并有 \(\lim_{x\to +\infty}f(x) = c 或 \pm\infty\)，则至少存在一个\(\xi\in(a,+\infty)\)，使得 \(f'(\xi) = 0\) 
4. 若函数 \(f(x)\) 在区间 \((-\infty,b]\) 上连续且可导，并有\(\lim_{x\to -\infty}f(x) = c 或 \pm\infty\)，则至少存在一个\(\xi\in(-\infty,b]\)，使得 \(f'(\xi) = 0\)

### 拉格朗日中值定理

几何意义：弧AB上至少有一点C，使点C处的切线平行于直线弦AB；罗尔中值定理是拉格朗日中值定理的特例

设函数 \(f(x)\) 满足，闭区间 \([a,b]\) 连续，开区间 \((a,b)\) 可导，则存在 \(\xi \in(a,b)\)，使得 \(\frac{f(b)-f(a)}{b-a} = f'(\xi)\)

另外一种表示形式：\(f(b)-f(a) = f'[a+(b-a)\theta](b-a)，(0<\theta<1)\)

**证明：**  
构造辅助函数，线段 \(ab\) 对应函数 \(L(x), L(x) = f(a) + \frac{f(b)-f(a)}{b-a}(x-a) \)  
令 \(\varphi(x) = f(x) - L(x) = f(x) - f(a) - \frac{f(b)-f(a)}{b-a}(x-a) \)  
\(\varphi(a)=\varphi(b)\)，根据罗尔中值定理，存在 \(\xi\in(a,b)\)，使得 \(\varphi'(\xi) = 0 \)

\(\varphi'(\xi) = f'(\xi) - \frac{f(b)-f(a)}{b-a} = 0，即\frac{f(b)-f(a)}{b-a} = f'(\xi)\)

### 柯西中值定理

可以视作在参数方程下拉格朗日中值定理的表达形式，用于解决没法保证拉格朗日中值定理2个 \(\xi\) 是同一个的问题，拉格朗日中值定理为 \(g(x)\) 等于 \(x\) 的特殊情况，为拉格朗日中值定理的推广；几何意义：用参数方程表示的曲线上至少有一点，它的切线平行于两端点所在的弦

设函数 \(f(x)\) 和 \(g(x)\) 满足闭区间 \([a,b]\) 皆连续，开区间 \((a,b)\) 皆可导；对于任意 \( x\in(a,b)，g'(x) \ne 0，g(a) \ne g(b) \)，则存在\(\xi \in(a,b)\)，使得 \(\frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)}\)

**证明：**

不可基于拉格朗日中值定理证明，没法保证2个 \(\xi\) 是同一个
因 \(g(a) \ne g(b)\)，令 \(L(x) = f(x) - \frac{f(b)-f(a)}{g(a)-g(a)}g(x)\)  
根据罗尔中值定理，\(\exists\xi\in(a,b)\) 使得 \(L'(\xi)=0\)，即： 
\( L'(\xi) = f'(\xi) - \frac{f(b)-f(a)}{g(b)-g(a)}g'(\xi) = 0 \because g'(\xi) \ne 0 \therefore \exists\xi\in(a,b) 使得 \frac{f(b)-f(a)}{g(b)-g(a)} = \frac{f'(\xi)}{g'(\xi)} \)

罗尔中值定理、拉格朗日中值定理和柯西中值定理称为微分三大中值定理

{{< hint info >}}
**为什么条件都是开区间连续，闭区间可导？**

说法是否严谨层面的区别：端点处要么左极限不存在，要么右极限不存在，是不可导的，所以不能说在闭区间可导
但为什么连续是闭区间呢，因为连续在左端点连续的意思是右连续，反之左连续
{{< /hint >}}

## 泰勒公式

泰勒公式是将一个在 \(x=x_0\) 处具有 \(n\) 阶导数的函数 \(f(x)\) 利用关于\((x-x_0)\)的n次多项式来逼近函数的方法，逼近的效果与多项式的阶数直接相关，通过各阶导数确定多项式的系数

泰勒公式的余项有两种主要形式：佩亚诺余项和拉格朗日余项

定性分析：佩亚诺余项 

若函数 \(f(x)\) 在 \(x_0\) 处的 \(n\) 阶导数均存在，则存在邻域 \(U(x_0,\delta)\) (\(\delta\) 介于 \(x\) 与 \(x_0\) 之间) 使得 \(f(x)\) 满足以下公式：
\(f(x) = \sum_{k=0}^n\frac{f^k(x_0)(x-x_0)^k}{k!} + r_n(x)\) 

其中佩亚诺Peano余项 \(r_n(x) = o((x-x_0)^n)(x\to x_0)\)，表示函数在近似值与真实值之间的误差，余下的 \(n\) 次多项式记为 \(P_{n}\) 即 \(x_{0}\)处的n次泰勒Taylor多项式


定量分析：拉格朗日余项

若函数 \(f(x)\) 在闭区间 \([a,b]\) 上存在n阶连续导数，在开区间 \((a,b)\) 上存在 \(n + 1\) 阶导数，
取一定点 \(x_0 \in [a,b]\)，则\(\forall x \in [a,b]，f(x) = \sum_{k=0}^n\frac{f^k(x_0)(x-x_0)^k}{k!} + r_n(x) \)  
其中拉格朗日Lagrange余项 \(r_n(x) = \frac{f^{n+1}(\xi)(x-x_0)^{n+1}}{(n+1)!}\)，其中 \(\xi \in (x,x_0)，设x < x_0\)  

当n=0时，泰勒公式表现为拉格朗日中值定理的形式

## 麦克劳林公式

麦克劳林公式是在 \(x=0\) 点处展开的泰勒公式

如果 \(x_0 = 0\)，那么未带有以上两种余项形式的 Taylor 公式又称为 Maclaurin 公式，此即  
\(f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + ... + \frac{f^{(n)}(0)}{n!}x^n + o(x^n) \)  
和  
\(f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + ... + \frac{f^{(n)}(0)}{n!}x^n + \frac{f^{(n+1)}(\theta x)}{(n+1)!}x^{n+1} (0<\theta<1)\)
可以令 n +1 = k，只求到k阶导数


常用函数的麦克劳林公式的展开式如下：
$$
\begin{align}
e^x = \sum_{n=0}^{\infty} \frac{x^n}{n!} \\
\sin x = \sum_{n=0}^{\infty} (-1)^n \frac{x^{2n+1}}{(2n+1)!} \\
\cos x = \sum_{n=0}^{\infty} (-1)^n \frac{x^{2n}}{(2n)!} \\
\ln(1+x) = \sum_{n=1}^{\infty} (-1)^{n-1} \frac{x^{n}}{n} \\
(1+x)^a = 1 + \sum_{n=1}^{\infty}\frac{\alpha(\alpha-1)...(\alpha-n+1)}{n!}x^n \\
\end{align}
$$

几个重要的低阶展开的麦克劳林公式：
$$
\begin{align}
\sin 𝑥 = 𝑥 − \frac{𝑥^3}{3!}+𝑂(𝑥^3)，\arcsin 𝑥 = 𝑥 + \frac{𝑥^3}{3!} + 𝑂(𝑥^3) \\
\tan 𝑥 = 𝑥 + \frac{𝑥^3}{3} + 𝑂(𝑥^3)，\arctan 𝑥 = 𝑥 − \frac{𝑥^3}{3} +𝑂(𝑥3) \\
\cos 𝑥 = 1 − \frac{𝑥^2}{2!} + \frac{𝑥^4}{4!} + 𝑂(𝑥^4)，\arccos 𝑥 = \frac{\pi}{2} − 𝑥 − \frac{𝑥^3}{3!}−𝑂(𝑥^3) \\
\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} + 𝑂(𝑥^3) \\
e^x = 1 + x + \frac{x^2}{2} + \frac{x^3}{3} + 𝑂(𝑥^3) \\
(1+x)^\alpha = 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + O(x^2) \\
\end{align}
$$

利用上述函数可以得到一组差函数的无穷小等价替换，例如：\(x - sin \sim \frac{x^3}{6}\)