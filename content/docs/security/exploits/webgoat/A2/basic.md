---
title: "Crypto Basics"
weight: 1
bookToc: false
---

#### 1 Base64

![](/data/image/security/exploit/webgoat/A2/base64/image-1.png)

![](/data/image/security/exploit/webgoat/A2/base64/image.png)

---

#### 2 XOR

使用 [https://strelitzia.net/wasXORdecoder/wasXORdecoder.html](https://strelitzia.net/wasXORdecoder/wasXORdecoder.html) 进行 IBM WebSphere 的 xor encoding/decoding，得到`databasepassword`

![](/data/image/security/exploit/webgoat/A2/xor/image.png)

---

#### 3 hash

找hash对应的原文密码

![](/data/image/security/exploit/webgoat/A2/hash/image.png)

md5 16字节，sha256 32字节
```bash
hashcat 5F4DCC3B5AA765D61D8327DEB882CF99 # 提示md5 m 0
hashcat -m 0 -a 0 5F4DCC3B5AA765D61D8327DEB882CF99 /usr/share/wordlists/rockyou.txt.gz
5f4dcc3b5aa765d61d8327deb882cf99:password

hashcat 8C6976E5B5410415BDE908BD4DEE15DFB167A9C873FC4BB8A81F6F2AB448A918 # 提示sha2-256 m 1400
hashcat -m 1400 -a 0 8C6976E5B5410415BDE908BD4DEE15DFB167A9C873FC4BB8A81F6F2AB448A918 /usr/share/wordlists/rockyou.txt.gz

8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918:admin
```

#### 4 signatures

![](/data/image/security/exploit/webgoat/A2/sign/image.png)

将私钥保存成`pri.pem`使用`openssl`相关命令完成

```bash
openssl rsa -in pri.pem -noout -modulus
Modulus=AE82CF5DC1EA1117D4C81C9E3DC4A520F187D481B709FC7752F35B156C3DB114EEA7DAF056966C3AF75B7A3C325645BEAC2E40F418952F5CA99BF0669E923DB1ACD4387E65F640A278ACF4C6A677A663C47C5BB06C09C6BBC40993E4E04099EDFCC9C98E15726EDBD254EA101557553D8F9A40B6F6C199BA2D9C6C226C38DB8A31DC284527903F9B580CF23AF41A18CB81FA7B65361BFF4BBD12709B2A157E8EAC373566C118051F43F39229FDE30C311ADD4C81C85E6C475AA7948720C0A3E732381DDE2777899B075029DB0AD96004ABCAE978631C3BF7CF48BE5491FA2BA7E7B7F934932AF82367EF64409EA9A5859D5C1A2B0F37B30F894407CE89941933

echo -n "AE82CF5DC1EA1117D4C81C9E3DC4A520F187D481B709FC7752F35B156C3DB114EEA7DAF056966C3AF75B7A3C325645BEAC2E40F418952F5CA99BF0669E923DB1ACD4387E65F640A278ACF4C6A677A663C47C5BB06C09C6BBC40993E4E04099EDFCC9C98E15726EDBD254EA101557553D8F9A40B6F6C199BA2D9C6C226C38DB8A31DC284527903F9B580CF23AF41A18CB81FA7B65361BFF4BBD12709B2A157E8EAC373566C118051F43F39229FDE30C311ADD4C81C85E6C475AA7948720C0A3E732381DDE2777899B075029DB0AD96004ABCAE978631C3BF7CF48BE5491FA2BA7E7B7F934932AF82367EF64409EA9A5859D5C1A2B0F37B30F894407CE89941933" > msg.txt

openssl dgst -sha256 -sign pri.pem -out sig.bin msg.txt

openssl base64 -A -in sig.bin
mRULPa7Mv/u7OWJBL78T/dHgz5Up6ai1Jg1lsK0lf2o+/QjEAVTfBsLr9gFUJOvP5pu94NkhoS/sfPAug5t9Pw7ZsHFhRxEnCQKIlUVgd02hGimK7MfwK+UCQoAdDSUDmHQpAF/sqMbypAnrStb14MC0pBj+OpJgaC5e2ldOVzg7EX471hhXgBLR0pK/Fl+u8IQXqJvkLyibshD5L+t4ZIl1I3D1SK5LJqJXWny1X17Ce8ShbNkoP3Zi2P4xeSmxzAhuu6jrJafigRiYFIxjLFZavuh6+5q9uuBEhaauO5IA6Vm0ecQd1/keW6npXzzuQ73XQ/aNdZ0u7fv5jVVsvw==
```