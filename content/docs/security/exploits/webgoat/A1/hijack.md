---
title: "Hijack a session"
weight: 1
bookToc: false
---

**目标：通过预测`hijack_cookie`的值，获取其他已认证用户的会话。**

`Proxy`->`HTTP history`->`Send to Repeater`

![](/data/image/security/exploit/webgoat/A1/hijack/1.png)

删除`Cookie`头中的`hijack_cookie`，发送2次，得到`hijack_cookie`的值分别是
```
hijack_cookie=9134839005677988100-1768923446901
hijack_cookie=9134839005677988102-1768923448936
```

推测出来`hijack_cookie`可能前半部分是个随机且递增的数，后半部分是个时间戳。

**那么中间缺失的`9134839005677988101-(1768923446901-8936)`可能代表其他已认证用户的会话。**

右键`Send to Intruder`，`Payloads`选择`Numbers`，`From 6901 to 8936`，`Start attack`（注意攻击速率不要太快，会导致数据库错误）

![](/data/image/security/exploit/webgoat/A1/hijack/2.png)

这里发现`9134839005677988101`和`9134839005677988100`的时间戳是一样的，这是因为webgoat代码写的是生成`hijack_cookie`时会随机在生成一个给答案使用，但是正常思路还是如上

`Sequencer`分析得出结论`extremely poor`

![](/data/image/security/exploit/webgoat/A1/hijack/0.png)
